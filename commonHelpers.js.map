{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const searchForm = document.querySelector('.search-form');\n  const gallery = document.querySelector('.gallery');\n  const loaderEl = document.querySelector('.loader');\n  const loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\n  const messageFinishGallery = document.querySelector('.finish-loader');\n\n  const BASE_URL = 'https://pixabay.com/api';\n  const API_KEY = '41900218-778e908913d1efd90b8f97d56';\n  const queryParams = {\n    query: '',\n    page: 1,\n    maxPage: 0,\n    pageSize: 40,\n  };\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  const iziToastConfig = {\n    position: 'topRight',\n    backgroundColor: 'red',\n    icon: 'none',\n  };\n\n  searchForm.addEventListener('submit', fetchData);\n  loadMoreBtn.addEventListener('click', loadMoreData);\n\n  async function fetchData(event) {\n    event.preventDefault();\n\n    loaderEl.style.display = 'block';\n    loadMoreBtn.classList.add('is-hidden');\n    messageFinishGallery.classList.add('is-hidden');\n    gallery.innerHTML = '';\n\n    const form = event.currentTarget;\n    queryParams.query = form.elements.query.value.trim();\n    queryParams.page = 1;\n\n    if (!queryParams.query) {\n      loaderEl.style.display = 'none';\n      iziToast.error({\n        ...iziToastConfig,\n        message: 'Enter a query value, please',\n      });\n      return;\n    }\n\n    try {\n      const resp = await getImages(queryParams.query);\n      if (resp.data.hits.length === 0) {\n        iziToast.error({\n          ...iziToastConfig,\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n      } else {\n        renderData(resp.data.hits);\n        queryParams.maxPage = Math.ceil(\n          resp.data.totalHits / queryParams.pageSize\n        );\n      }\n      updateUI();\n      form.reset();\n    } catch (err) {\n      showError();\n    }\n  }\n\n  async function getImages(query) {\n    const searchParams = new URLSearchParams({\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: queryParams.pageSize,\n      page: queryParams.page,\n    });\n    return axios.get(`${BASE_URL}/?${searchParams}`);\n  }\n\n  async function loadMoreData() {\n    queryParams.page += 1;\n    loaderEl.style.display = 'block';\n    loadMoreBtn.classList.add('is-hidden');\n\n    try {\n      const respNext = await getImages(queryParams.query);\n      renderData(respNext.data.hits);\n      updateUI();\n    } catch (err) {\n      showError();\n    }\n  }\n\n  function renderData(images) {\n    const markup = images\n      .map(image => {\n        const {\n          largeImageURL: largeURL,\n          webformatURL: webURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        } = image;\n\n        return `\n        <li class=\"gallery-card\">\n            <a class=\"gallery-link\" href=\"${largeURL}\">\n                <img class=\"gallery-image\" src=\"${webURL}\" alt=\"${tags}\"/>\n            </a>\n            <div class=\"titles-box\">\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Likes:</p>\n                    <p class=\"title-value\">${likes}</p>\n                </div>\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Views:</p>\n                    <p class=\"title-value\">${views}</p>\n                </div>\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Comments:</p>\n                    <p class=\"title-value\">${comments}</p>\n                </div>\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Downloads:</p>\n                    <p class=\"title-value\">${downloads}</p>\n                </div>\n            </div>\n        </li>\n      `;\n      })\n      .join('');\n\n    gallery.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n  }\n\n  function updateUI() {\n    if (queryParams.page === queryParams.maxPage) {\n      messageFinishGallery.classList.remove('is-hidden');\n      loadMoreBtn.classList.add('is-hidden');\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n    loaderEl.style.display = 'none';\n  }\n\n  function showError() {\n    iziToast.error({\n      ...iziToastConfig,\n      message: 'Oops, server connection error!',\n    });\n    loaderEl.style.display = 'none';\n  }\n});\n"],"names":["searchForm","gallery","loaderEl","loadMoreBtn","messageFinishGallery","BASE_URL","API_KEY","queryParams","lightbox","SimpleLightbox","iziToastConfig","fetchData","loadMoreData","event","form","iziToast","resp","getImages","renderData","updateUI","showError","query","searchParams","axios","respNext","images","markup","image","largeURL","webURL","tags","likes","views","comments","downloads"],"mappings":"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"}