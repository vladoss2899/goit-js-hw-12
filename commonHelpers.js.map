{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Імпорт необхідних модулів і бібліотек\nimport axios from 'axios'; // для здійснення запитів HTTP\nimport iziToast from 'izitoast'; // для відображення сповіщень\nimport 'izitoast/dist/css/iziToast.min.css'; // стилі для iziToast\nimport SimpleLightbox from 'simplelightbox'; // для створення галереї зображень\nimport 'simplelightbox/dist/simple-lightbox.min.css'; // стилі для SimpleLightbox\n\n// Код, що виконується при завантаженні DOM\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Отримання посилань на елементи DOM\n  const searchFormElement = document.querySelector('.search-form'); // форма пошуку\n  const galleryElement = document.querySelector('.gallery'); // елемент галереї\n  const loaderElement = document.querySelector('.loader'); // елемент завантажувача\n  const loadMoreButton = document.querySelector('[data-action=\"load-more\"]'); // кнопка \"Load More\"\n  const messageFinishGalleryElement = document.querySelector('.finish-loader'); // повідомлення про завершення галереї\n\n  // Константи та змінні для роботи з API Pixabay\n  const PIXABAY_BASE_URL = 'https://pixabay.com/api';\n  const PIXABAY_API_KEY = '41900218-778e908913d1efd90b8f97d56';\n  const queryParameters = {\n    query: '', // пошуковий запит\n    page: 1, // поточна сторінка\n    maxPage: 0, // максимальна сторінка\n    pageSize: 15, // розмір сторінки\n  };\n\n  // Створення об'єкту SimpleLightbox для галереї\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  // Конфігурація для iziToast\n  const iziToastConfig = {\n    position: 'topRight',\n    backgroundColor: 'red',\n    icon: 'none',\n  };\n\n  // Додавання обробника події для подачі форми пошуку\n  searchFormElement.addEventListener('submit', fetchData);\n\n  // Додавання обробника події для кнопки \"Load More\"\n  loadMoreButton.addEventListener('click', loadMoreData);\n\n  // Функція для отримання даних з API Pixabay\n  async function fetchData(event) {\n    event.preventDefault(); // запобігання перезавантаженню сторінки при подачі форми\n\n    // Відображення завантажувача та приховання кнопки \"Load More\" та повідомлення про завершення галереї\n    loaderElement.style.display = 'block';\n    loadMoreButton.classList.add('is-hidden');\n    messageFinishGalleryElement.classList.add('is-hidden');\n    galleryElement.innerHTML = ''; // очищення галереї перед новим пошуком\n\n    // Отримання значення пошукового запиту з форми\n    const formElement = event.currentTarget;\n    queryParameters.query = formElement.elements.query.value.trim(); // отримання значення із поля вводу\n    queryParameters.page = 1; // скидання сторінки на першу при новому пошуковому запиті\n\n    // Перевірка на наявність пошукового запиту\n    if (!queryParameters.query) {\n      loaderElement.style.display = 'none';\n      iziToast.error({\n        ...iziToastConfig,\n        message: 'Enter a query value, please',\n      });\n      return;\n    }\n\n    try {\n      // Отримання даних з API Pixabay\n      const response = await getImages(queryParameters.query);\n\n      // Перевірка наявності результатів\n      if (response.data.hits.length === 0) {\n        // Відображення повідомлення про відсутність зображень\n        iziToast.error({\n          ...iziToastConfig,\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n      } else {\n        // Відображення результатів пошуку\n        renderData(response.data.hits);\n        queryParameters.maxPage = Math.ceil(\n          response.data.totalHits / queryParameters.pageSize\n        );\n\n        // Перевірка наявності контенту для відображення кнопки \"Load More\"\n        if (response.data.hits.length > 0) {\n          loadMoreButton.classList.remove('is-hidden'); // показ кнопки \"Load More\"\n        } else {\n          loadMoreButton.classList.add('is-hidden'); // приховання кнопки \"Load More\"\n        }\n      }\n\n      // Оновлення інтерфейсу користувача та скидання форми пошуку\n      updateUI();\n      formElement.reset();\n    } catch (error) {\n      // Відображення повідомлення про помилку при отриманні даних з сервера\n      showError();\n    } finally {\n      // Приховання завантажувача після завершення операції\n      loaderElement.style.display = 'none';\n    }\n  }\n\n  // Функція для оновлення інтерфейсу користувача\n  function updateUI() {\n    if (queryParameters.page === queryParameters.maxPage) {\n      messageFinishGalleryElement.classList.remove('is-hidden');\n      loadMoreButton.classList.add('is-hidden');\n    } else {\n      loadMoreButton.classList.remove('is-hidden');\n    }\n    loaderElement.style.display = 'none';\n  }\n\n  // Функція для отримання зображень з API Pixabay\n  async function getImages(query) {\n    const searchParams = new URLSearchParams({\n      key: PIXABAY_API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: queryParameters.pageSize,\n      page: queryParameters.page,\n    });\n    return axios.get(`${PIXABAY_BASE_URL}/?${searchParams}`);\n  }\n\n  // Функція для відображення зображень у галереї\n  function renderData(images) {\n    const markup = images\n      .map(image => {\n        const {\n          largeImageURL: largeURL,\n          webformatURL: webURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        } = image;\n\n        return `\n          <li class=\"gallery-card\">\n              <a class=\"gallery-link\" href=\"${largeURL}\">\n                  <img class=\"gallery-image\" src=\"${webURL}\" alt=\"${tags}\"/>\n              </a>\n              <div class=\"titles-box\">\n                  <div class=\"title-element\">\n                      <p class=\"title-text\">Likes:</p>\n                      <p class=\"title-value\">${likes}</p>\n                  </div>\n                  <div class=\"title-element\">\n                      <p class=\"title-text\">Views:</p>\n                      <p class=\"title-value\">${views}</p>\n                  </div>\n                  <div class=\"title-element\">\n                      <p class=\"title-text\">Comments:</p>\n                      <p class=\"title-value\">${comments}</p>\n                  </div>\n                  <div class=\"title-element\">\n                      <p class=\"title-text\">Downloads:</p>\n                      <p class=\"title-value\">${downloads}</p>\n                  </div>\n              </div>\n          </li>\n        `;\n      })\n      .join('');\n\n    galleryElement.insertAdjacentHTML('beforeend', markup); // відображення зображень у галереї\n    lightbox.refresh(); // оновлення галереї після додавання нових зображень\n  }\n\n  // Функція для відображення повідомлення про помилку\n  function showError() {\n    iziToast.error({\n      ...iziToastConfig,\n      message: 'Oops, server connection error!',\n    });\n  }\n\n  // Функція для завантаження наступної сторінки зображень\n  async function loadMoreData() {\n    queryParameters.page += 1; // інкремент сторінки\n    loaderElement.style.display = 'block'; // відображення завантажувача\n    loadMoreButton.classList.add('is-hidden'); // приховання кнопки \"Load More\"\n\n    try {\n      // Отримання наступної сторінки зображень\n      const nextResponse = await getImages(queryParameters.query);\n      // Відображення отриманих зображень\n      renderData(nextResponse.data.hits);\n      updateUI();\n\n      // Прокрутка сторінки до нижньої частини, де розташована кнопка \"Load More\"\n      window.scrollTo({\n        top: document.body.scrollHeight,\n        behavior: 'smooth', // Зробить прокрутку плавною\n      });\n    } catch (error) {\n      // Відображення повідомлення про помилку при отриманні даних з сервера\n      showError();\n    }\n  }\n});\n"],"names":["searchFormElement","galleryElement","loaderElement","loadMoreButton","messageFinishGalleryElement","PIXABAY_BASE_URL","PIXABAY_API_KEY","queryParameters","lightbox","SimpleLightbox","iziToastConfig","fetchData","loadMoreData","event","formElement","iziToast","response","getImages","renderData","updateUI","showError","query","searchParams","axios","images","markup","image","largeURL","webURL","tags","likes","views","comments","downloads","nextResponse"],"mappings":"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"}