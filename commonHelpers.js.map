{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const searchFormElement = document.querySelector('.search-form');\n  const galleryElement = document.querySelector('.gallery');\n  const loaderElement = document.querySelector('.loader');\n  const loadMoreButton = document.querySelector('[data-action=\"load-more\"]');\n  const messageFinishGalleryElement = document.querySelector('.finish-loader');\n\n  const PIXABAY_BASE_URL = 'https://pixabay.com/api';\n  const PIXABAY_API_KEY = '41900218-778e908913d1efd90b8f97d56';\n  const queryParameters = {\n    query: '',\n    page: 1,\n    maxPage: 0,\n    pageSize: 40,\n  };\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  const iziToastConfig = {\n    position: 'topRight',\n    backgroundColor: 'red',\n    icon: 'none',\n  };\n\n  searchFormElement.addEventListener('submit', fetchData);\n  loadMoreButton.addEventListener('click', loadMoreData);\n\n  async function fetchData(event) {\n    event.preventDefault();\n\n    loaderElement.style.display = 'block';\n    loadMoreButton.classList.add('is-hidden');\n    messageFinishGalleryElement.classList.add('is-hidden');\n    galleryElement.innerHTML = '';\n\n    const formElement = event.currentTarget;\n    queryParameters.query = formElement.elements.query.value.trim();\n    queryParameters.page = 1;\n\n    if (!queryParameters.query) {\n      loaderElement.style.display = 'none';\n      iziToast.error({\n        ...iziToastConfig,\n        message: 'Enter a query value, please',\n      });\n      return;\n    }\n\n    try {\n      const response = await getImages(queryParameters.query);\n      if (response.data.hits.length === 0) {\n        iziToast.error({\n          ...iziToastConfig,\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n      } else {\n        renderData(response.data.hits);\n        queryParameters.maxPage = Math.ceil(\n          response.data.totalHits / queryParameters.pageSize\n        );\n      }\n      updateUI();\n      formElement.reset();\n    } catch (error) {\n      showError();\n    }\n  }\n\n  async function getImages(query) {\n    const searchParams = new URLSearchParams({\n      key: PIXABAY_API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: queryParameters.pageSize,\n      page: queryParameters.page,\n    });\n    return axios.get(`${PIXABAY_BASE_URL}/?${searchParams}`);\n  }\n\n  async function loadMoreData() {\n    queryParameters.page += 1;\n    loaderElement.style.display = 'block';\n    loadMoreButton.classList.add('is-hidden');\n\n    try {\n      const nextResponse = await getImages(queryParameters.query);\n      renderData(nextResponse.data.hits);\n      updateUI();\n    } catch (error) {\n      showError();\n    }\n  }\n\n  function renderData(images) {\n    const markup = images\n      .map(image => {\n        const {\n          largeImageURL: largeURL,\n          webformatURL: webURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        } = image;\n\n        return `\n        <li class=\"gallery-card\">\n            <a class=\"gallery-link\" href=\"${largeURL}\">\n                <img class=\"gallery-image\" src=\"${webURL}\" alt=\"${tags}\"/>\n            </a>\n            <div class=\"titles-box\">\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Likes:</p>\n                    <p class=\"title-value\">${likes}</p>\n                </div>\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Views:</p>\n                    <p class=\"title-value\">${views}</p>\n                </div>\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Comments:</p>\n                    <p class=\"title-value\">${comments}</p>\n                </div>\n                <div class=\"title-element\">\n                    <p class=\"title-text\">Downloads:</p>\n                    <p class=\"title-value\">${downloads}</p>\n                </div>\n            </div>\n        </li>\n      `;\n      })\n      .join('');\n\n    galleryElement.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n  }\n\n  function updateUI() {\n    if (queryParameters.page === queryParameters.maxPage) {\n      messageFinishGalleryElement.classList.remove('is-hidden');\n      loadMoreButton.classList.add('is-hidden');\n    } else {\n      loadMoreButton.classList.remove('is-hidden');\n    }\n    loaderElement.style.display = 'none';\n  }\n\n  function showError() {\n    iziToast.error({\n      ...iziToastConfig,\n      message: 'Oops, server connection error!',\n    });\n    loaderElement.style.display = 'none';\n  }\n});\n"],"names":["searchFormElement","galleryElement","loaderElement","loadMoreButton","messageFinishGalleryElement","PIXABAY_BASE_URL","PIXABAY_API_KEY","queryParameters","lightbox","SimpleLightbox","iziToastConfig","fetchData","loadMoreData","event","formElement","iziToast","response","getImages","renderData","updateUI","showError","query","searchParams","axios","nextResponse","images","markup","image","largeURL","webURL","tags","likes","views","comments","downloads"],"mappings":"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"}